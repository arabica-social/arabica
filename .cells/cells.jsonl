{"id":"01KGA7S43ENCHDZQ9DXPGEA6W1","title":"Consolidate three modal systems into one","description":"CRITICAL: Consolidate three different modal implementations:\n- entity_modals.templ (Alpine.js x-show)\n- dialog_modals.templ (native HTML5 \u003cdialog\u003e)\n- profile.templ (inline Alpine modals)\n\nRecommendation: Migrate all to native \u003cdialog\u003e for modern standard and better a11y.\nRemove Alpine.js modal code and inline modal implementations.\n\nAcceptance criteria:\n- All modals use consistent implementation\n- Better accessibility\n- Reduced maintenance burden","status":"completed","priority":"high","assignee":"patrick","change_id":"zvoovqqnlutxuzrwzpslzvxvsokyvyux","labels":["frontend","refactor","modals"],"created_at":"2026-01-31T14:37:13.710608293Z","updated_at":"2026-01-31T15:07:11.640016975Z","completed_at":"2026-01-31T15:07:11.609500036Z"}
{"id":"01KGA7SZW8TPBWJZ40DHFC9RSF","title":"Fix modal fade-out animations","description":"Modals don't fade out on save/cancel as expected. They should smoothly transition out.\n\nAcceptance criteria:\n- Modals fade out smoothly when closed\n- Consistent animation timing\n- Works for both save and cancel actions","status":"completed","priority":"normal","labels":["frontend","modals","ux"],"created_at":"2026-01-31T14:37:42.152625516Z","updated_at":"2026-01-31T22:01:05.514388522Z","completed_at":"2026-01-31T22:01:05.499540746Z"}
{"id":"01KGA7SZY65S5V97C7B3PKA172","title":"Fix feed view details button","description":"Feed item 'view details' button should be removed. The 'new brew' text in 'added a new brew' should link to view page instead (underline this text).\n\nAcceptance criteria:\n- Remove 'view details' button\n- Make 'new brew' text clickable and underlined\n- Links to correct brew view page","status":"completed","priority":"normal","labels":["frontend","feed","ux"],"created_at":"2026-01-31T14:37:42.214656646Z","updated_at":"2026-01-31T16:28:52.517267974Z","completed_at":"2026-01-31T16:28:52.506611951Z"}
{"id":"01KGA7T004T9HZR1Q5MHSC48G6","title":"Fix manage page notes truncation","description":"Manage brews page truncates notes unnecessarily, while variables wrap to many more lines.\n\nAcceptance criteria:\n- Notes should not be truncated (or have higher character limit)\n- Consistent text wrapping behavior\n- Better readability","status":"completed","priority":"low","labels":["frontend","manage","ux"],"created_at":"2026-01-31T14:37:42.276141862Z","updated_at":"2026-01-31T21:36:44.490824871Z","completed_at":"2026-01-31T21:36:44.478912822Z"}
{"id":"01KGA7T026JJ8H9EK24K17QRA4","title":"Improve loading UX with progress bars or transitions","description":"Loading on HTMX could be snappier with loading bars or transitionary animations.\n\nOptions:\n- Loading bar waiting until everything is loaded\n- Transitionary animations between skeleton and full loads\n- Reconsider if skeleton loading is needed with SSR (probably yes due to PDS data fetches)\n\nAcceptance criteria:\n- Smoother loading experience\n- No jarring transitions\n- Consistent loading indicators","status":"open","priority":"normal","labels":["frontend","ux","htmx"],"created_at":"2026-01-31T14:37:42.342432216Z","updated_at":"2026-01-31T14:37:42.342432216Z"}
{"id":"01KGA7T04HWD93MJQDKZ62XQNB","title":"Fix skeleton headers to match actual table headers","description":"Headers in loading skeletons need to exactly match final table headers.\n\nCurrent issue:\n- Profile refresh shows brew headers for all tabs\n- Inconsistent column counts (brew_list: 6 cols, profile: 5 cols, manage: 5 cols)\n\nAcceptance criteria:\n- Skeleton headers match actual content headers\n- Tab-specific skeletons or dynamic skeletons based on active tab\n- Consistent column structure","status":"open","priority":"normal","labels":["frontend","ux","skeleton"],"created_at":"2026-01-31T14:37:42.417653543Z","updated_at":"2026-01-31T14:37:42.417653543Z"}
{"id":"01KGA7T06FC5V4Z92570G0BY5G","title":"Style mail link and back button on terms page","description":"Add proper styling to mail link and 'back to home' button on terms page.\n\nAcceptance criteria:\n- Consistent button/link styling\n- Matches site design system\n- Good visual hierarchy","status":"completed","priority":"low","assignee":"patrick","change_id":"znoumknmuoxkwwrrzrlvtonksrokkvnu","labels":["frontend","styling"],"created_at":"2026-01-31T14:37:42.479212418Z","updated_at":"2026-02-01T00:25:41.74512756Z","completed_at":"2026-02-01T00:25:41.714091178Z"}
{"id":"01KGA7T08BAWPB977KSHZNS8NE","title":"Revision pass on about and terms text","description":"Review and revise text content in about and terms pages for clarity and accuracy.\n\nAcceptance criteria:\n- Clear, concise messaging\n- No typos or grammar issues\n- Accurate information","status":"claimed","priority":"low","assignee":"patrick","labels":["content","documentation"],"created_at":"2026-01-31T14:37:42.539757583Z","updated_at":"2026-01-31T15:30:48.329882372Z"}
{"id":"01KGA7T0AE0R3F8PRHX761W03E","title":"Implement profile picture caching in database","description":"Cache profile pictures to database to avoid reloading them frequently. This may already be partially implemented - needs investigation.\n\nAcceptance criteria:\n- Profile pictures cached in database\n- Reduced PDS API calls for avatar fetching\n- Cache invalidation strategy\n- Performance improvement","status":"open","priority":"high","labels":["backend","performance","caching"],"created_at":"2026-01-31T14:37:42.606749189Z","updated_at":"2026-01-31T14:37:42.606749189Z"}
{"id":"01KGA7T0CRPVYSNS9FHE13NMQC","title":"Fix double page transition on back navigation","description":"Hitting back from /brews/new to home page shows welcome box, then transitions in - looks bad.\n\nIssue: Transition seems to trigger twice\nRoot cause: Transition code may be brittle\n\nAcceptance criteria:\n- Single smooth transition on back navigation\n- No double-rendering of welcome box\n- Consider refactoring transition code to be less brittle","status":"completed","priority":"normal","labels":["frontend","navigation","transitions"],"created_at":"2026-01-31T14:37:42.680660721Z","updated_at":"2026-01-31T21:37:20.31354036Z","completed_at":"2026-01-31T21:37:20.300721855Z"}
{"id":"01KGA7TZ6365GY1YG55BGYVKMH","title":"Fix non-functional back button on view page","description":"Back button on brew view page does nothing and produces no logs.\n\nAcceptance criteria:\n- Back button navigates to previous page\n- Proper navigation behavior\n- Debug logging if needed","status":"completed","priority":"normal","labels":["frontend","navigation","bug"],"created_at":"2026-01-31T14:38:14.211441899Z","updated_at":"2026-01-31T20:23:51.90297311Z","completed_at":"2026-01-31T20:23:51.889306189Z"}
{"id":"01KGA7TZ94GDGY53NFXW1K7K6Y","title":"Fix modal record creation not updating list","description":"Adding a record from a modal in brews page doesn't update the list until page refresh.\n\nOlder version on main branch had correct behavior: adds to list and auto-selects.\n\nAcceptance criteria:\n- New records appear in list immediately after creation\n- Auto-select newly created record\n- No page refresh needed","status":"completed","priority":"high","change_id":"kkktpzkmkwuwwrqoptsyoyuuwvqwwwrz","workspace_path":"/home/patrick/projects/arabica/.worktrees/cell-01KGA7TZ94GD","labels":["frontend","htmx","modals","bug"],"created_at":"2026-01-31T14:38:14.308945383Z","updated_at":"2026-01-31T15:55:09.476557868Z","completed_at":"2026-01-31T15:55:09.462025879Z"}
{"id":"01KGA7TZBJ5KYR9HVS57SY5CBD","title":"Reduce table flash on page load","description":"Tables flash briefly on load. Could load more smoothly, perhaps by delaying page until skeleton is rendered.\n\nProfile page does this well with profile banner and stats.\n\nAcceptance criteria:\n- Smoother table loading\n- No visible flash/jump\n- Better perceived performance","status":"completed","priority":"low","change_id":"opplvnrzuswososkrrsrurokmlltszwn","labels":["frontend","ux","performance"],"created_at":"2026-01-31T14:38:14.386960128Z","updated_at":"2026-01-31T16:27:23.272054602Z","completed_at":"2026-01-31T16:27:23.246146545Z"}
{"id":"01KGA7TZE5PE47X9JTQ85ZZJM4","title":"Refactor web code into organized subdirectory","description":"Move all frontend code into web subdirectory within internal.\n\nCurrent structure needs organization:\n- Move components and pages into separate dirs\n- Target: internal/web/components, internal/web/pages\n- bff directory should also move to internal/web/bff\n\nAcceptance criteria:\n- Clean directory structure\n- All imports updated\n- Tests still pass\n- No broken references","status":"completed","priority":"normal","labels":["refactor","structure"],"created_at":"2026-01-31T14:38:14.469128797Z","updated_at":"2026-01-31T21:41:04.12120685Z","completed_at":"2026-01-31T21:41:04.109407281Z"}
{"id":"01KGA7TZG6AP8FJJTW5GAA60X5","title":"Evaluate merging manage and profile pages","description":"Consider if manage, profile, and brew list should be separate pages.\n\nOptions:\n- Merge manage and profile\n- Merge brew list and manage\n- Keep separate\n\nNeeds design decision before implementation.\n\nAcceptance criteria:\n- Evaluate user flow and UX\n- Document decision rationale\n- Implementation plan if merge is chosen","status":"open","priority":"low","labels":["design","ux","frontend"],"created_at":"2026-01-31T14:38:14.534537889Z","updated_at":"2026-01-31T14:38:14.534537889Z"}
{"id":"01KGA7TZJDMR7DWT1M0MAKP6NR","title":"Standardize edit/delete buttons on profile tables","description":"Profile tables are inconsistent - some have edit/delete buttons, others don't.\n\nAlso consider adding buttons below each table for that record type.\n\nAcceptance criteria:\n- All tables have consistent button placement\n- Either all have edit/delete or none do\n- Add buttons below tables for adding new records\n- Consistent UX across all tables","status":"completed","priority":"normal","labels":["frontend","ux","consistency"],"created_at":"2026-01-31T14:38:14.605304682Z","updated_at":"2026-01-31T22:23:51.571545748Z","completed_at":"2026-01-31T22:23:51.559620864Z"}
{"id":"01KGA7TZMPFGZH6R6ZMASAD2GE","title":"Design nested modal system for entity creation","description":"Enable creating related entities from within modals (e.g., create roaster from within bean modal).\n\nDesign idea:\n- Transition that moves first modal left\n- Opens second modal to the right\n- Smooth nested flow\n\nAcceptance criteria:\n- Design nested modal UX\n- Smooth transitions\n- Good visual hierarchy\n- Can return to parent modal\n- Data flows correctly between modals","status":"blocked","priority":"low","blocked_by":["01KGA7S43ENCHDZQ9DXPGEA6W1"],"labels":["design","ux","modals","future"],"created_at":"2026-01-31T14:38:14.678025134Z","updated_at":"2026-01-31T14:38:59.768553798Z"}
{"id":"01KGA7TZPQPY2JC3HFPVPKHNBQ","title":"Refactor forms to use form components","description":"Form components in forms.templ are defined but rarely used (only in brew_form.templ).\nModals and other forms use inline HTML instead.\n\nComponents available:\n- TextInput\n- NumberInput\n- TextArea\n- Select\n- FormField\n\nAcceptance criteria:\n- All forms use form components\n- Remove inline form HTML\n- Consistent form styling\n- Better maintainability","status":"completed","priority":"normal","assignee":"patrick","change_id":"rlzoowttmqxrqwlmpkottlurxzsxslyu","labels":["refactor","frontend","forms"],"created_at":"2026-01-31T14:38:14.743183429Z","updated_at":"2026-01-31T14:58:58.965241694Z","completed_at":"2026-01-31T14:58:58.924457633Z"}
{"id":"01KGA7TZRHNG2AVHBT91NJY4KD","title":"Replace inline card classes with Card component","description":"card.templ defines Card component but many places use inline card classes instead.\n\nAcceptance criteria:\n- All card-style elements use Card component\n- Remove inline card class usage\n- Consistent card styling\n- Component-based approach","status":"completed","priority":"low","assignee":"patrick","change_id":"yokzvvstynposzwsznxpqptwstqrxzqu","labels":["refactor","frontend","components"],"created_at":"2026-01-31T14:38:14.801428078Z","updated_at":"2026-02-01T00:25:45.227470232Z","completed_at":"2026-02-01T00:25:45.186028348Z"}
{"id":"01KGA7TZTT05WWENTHR41X4RQH","title":"Replace inline buttons with button components","description":"buttons.templ defines PrimaryButton/SecondaryButton but they're rarely used.\nMost places use inline button classes.\n\nAcceptance criteria:\n- All buttons use button components\n- Remove inline button class usage\n- Consistent button styling\n- Component-based approach","status":"open","priority":"low","labels":["refactor","frontend","components"],"created_at":"2026-01-31T14:38:14.874329448Z","updated_at":"2026-01-31T14:38:14.874329448Z"}
{"id":"01KGA7VXDTVY5W11QJ1VPZ5M3Y","title":"Implement settings menu","description":"Create settings menu with the following features:\n\n1. Private mode - Don't show in community feed (records still public via PDS API)\n2. Dev mode - Show DID, copy DID in profiles (remove 'logged in as \u003cdid\u003e' from home)\n3. Toggle for table view vs future post-style view\n\nAcceptance criteria:\n- Settings page/modal created\n- All three settings implemented\n- Settings persisted per user\n- UI updated based on settings","status":"blocked","priority":"normal","blocked_by":["01KGA7VXFQABCAQV83A6C49WEY"],"labels":["feature","frontend","settings"],"created_at":"2026-01-31T14:38:45.178941765Z","updated_at":"2026-01-31T14:39:00.016324424Z"}
{"id":"01KGA7VXFQABCAQV83A6C49WEY","title":"Design post-style record view (mobile-friendly)","description":"LARGE FEATURE: Complete record styling refactor from table-style to mobile-friendly post-style.\n\nSimilar to Bluesky posts format.\nShould include setting to use legacy table view.\n\nThis is a major redesign - to be done later down the line.\n\nAcceptance criteria:\n- Design post-style layout\n- Mobile-friendly and responsive\n- Legacy table view option\n- Smooth migration path\n- Better UX on mobile devices","status":"open","priority":"low","labels":["feature","design","frontend","mobile","future"],"created_at":"2026-01-31T14:38:45.23927703Z","updated_at":"2026-01-31T14:38:45.23927703Z"}
{"id":"01KGA7VXHR31MSHEKH91C41TYM","title":"Add loading progress bars to page navigation","description":"Consider adding loading bars to page loads (above header perhaps).\n\nSeparate nicer/prettier loading bar would also be nice on brews page.\n\nAcceptance criteria:\n- Loading bar visible during page navigation\n- Positioned appropriately (above header)\n- Smooth animations\n- Better perceived performance","status":"open","priority":"low","labels":["feature","frontend","ux"],"created_at":"2026-01-31T14:38:45.304772299Z","updated_at":"2026-01-31T14:38:45.304772299Z"}
{"id":"01KGA7VXM0F3A1R10BC3V29A0Y","title":"Verify context flows through all methods","description":"From CLAUDE.md Known Issues: Context should flow through methods (some fixed, verify all paths).\n\nAudit codebase to ensure context.Context is properly passed through all method chains.\n\nAcceptance criteria:\n- All methods accept and use context\n- No context.Background() in handlers\n- Context cancellation works correctly\n- Request timeouts respected","status":"open","priority":"high","labels":["backend","refactor","correctness"],"created_at":"2026-01-31T14:38:45.376033105Z","updated_at":"2026-01-31T14:38:45.376033105Z"}
{"id":"01KGA7VXP6P4SMB1MTYFFM3WZH","title":"Fix cache race conditions with copy-on-write","description":"From CLAUDE.md Known Issues: Cache race conditions need copy-on-write pattern.\n\nCurrent caching implementation may have race conditions.\n\nAcceptance criteria:\n- Implement copy-on-write pattern\n- No data races (verified with -race flag)\n- Thread-safe cache operations\n- Performance maintained or improved","status":"open","priority":"high","labels":["backend","concurrency","bug","cache"],"created_at":"2026-01-31T14:38:45.446031585Z","updated_at":"2026-01-31T14:38:45.446031585Z"}
{"id":"01KGA7VXR4EVGR470P4M9JH80C","title":"Add CID validation on record updates","description":"From CLAUDE.md Known Issues: Missing CID validation on record updates (AT Protocol best practice).\n\nImplement CID (Content Identifier) validation when updating records to ensure record hasn't changed.\n\nAcceptance criteria:\n- CID validation on all record updates\n- Proper error handling for CID mismatches\n- Follows AT Protocol best practices\n- Tests covering CID validation","status":"open","priority":"normal","labels":["backend","atproto","validation"],"created_at":"2026-01-31T14:38:45.508526626Z","updated_at":"2026-01-31T14:38:45.508526626Z"}
{"id":"01KGA7VXT4S4VGYZ2FDE1RR2XX","title":"Implement rate limiting for PDS calls","description":"From CLAUDE.md Known Issues: Rate limiting for PDS calls not implemented.\n\nAdd rate limiting to prevent excessive API calls to PDS servers.\n\nAcceptance criteria:\n- Rate limiting implemented for PDS API calls\n- Configurable limits\n- Proper error handling when rate limited\n- Backoff strategy\n- Monitoring/logging of rate limit hits","status":"open","priority":"high","labels":["backend","performance","atproto"],"created_at":"2026-01-31T14:38:45.572884867Z","updated_at":"2026-01-31T14:38:45.572884867Z"}
{"id":"01KGA7VXVZQBMZX6RVG3B49TYW","title":"Consider migration from BoltDB to SQLite","description":"Far future consideration: Maybe swap from BoltDB to SQLite using non-cgo library.\n\nThis is exploratory - need to evaluate:\n- Benefits of SQLite vs BoltDB\n- Migration effort\n- Performance impact\n- Query capabilities\n\nAcceptance criteria:\n- Evaluate pros/cons\n- Document decision\n- If proceeding: migration plan and implementation","status":"claimed","priority":"low","assignee":"patrick","labels":["backend","database","future","evaluation"],"created_at":"2026-01-31T14:38:45.631852717Z","updated_at":"2026-01-31T15:31:07.948160371Z"}
{"id":"01KGACBM7JBN0G9R5PYXEPCFXS","title":"Fix manage page table refresh after modal operations","description":"The manage page tables don't refresh when entities are created, updated, or deleted via modals. The entity managers and entity-helpers already try to trigger refreshes but the HTMX element only responds to initial page load.","status":"completed","priority":"normal","assignee":"patrick","created_at":"2026-01-31T15:57:14.354187839Z","updated_at":"2026-01-31T16:08:49.974241439Z","completed_at":"2026-01-31T15:58:50.307512595Z","notes":[{"timestamp":"2026-01-31T15:57:40.913521034Z","author":"patrick","message":"## Problem\nThe entity managers (in manage-page.js) and entity-helpers.js already try to trigger refreshes by calling:\n  htmx.trigger(manageLoader, 'load')\n\nHowever, the HTMX element in manage.templ (line 64) has:\n  hx-trigger=\"load\"\n\nThis only responds to the initial page load event, not subsequent programmatic 'load' triggers.\n\n## Requirements\n1. Modify the HTMX trigger in manage.templ to respond to a custom refresh event\n2. Update manage-page.js entity manager onSuccess callbacks to dispatch the custom event\n3. Update entity-helpers.js refreshEntityDropdown to dispatch the custom event\n4. Ensure both creates and deletes trigger the refresh\n5. Test all CRUD operations for all entity types (beans, roasters, grinders, brewers)\n\n## Implementation Approach\n1. Add custom event listener to hx-trigger (e.g., 'load, refreshManage from:body')\n2. Dispatch 'refreshManage' event instead of/in addition to triggering 'load'\n3. Verify the event bubbles up to trigger the HTMX reload\n\n## Files to Modify\n- internal/web/pages/manage.templ (HTMX trigger)\n- web/static/js/manage-page.js (entity manager onSuccess callbacks)\n- web/static/js/entity-helpers.js (refreshEntityDropdown function)\n\n## Success Criteria\n- Creating an entity via modal immediately shows it in the table\n- Updating an entity via modal immediately shows changes in the table\n- Deleting an entity immediately removes it from the table\n- Works for all four entity types (beans, roasters, grinders, brewers)"},{"timestamp":"2026-01-31T15:58:47.084907175Z","author":"patrick","message":"## Implementation Complete\n\nModified three files to fix table refresh:\n\n1. **internal/web/pages/manage.templ**\n   - Updated hx-trigger to: 'load, refreshManage from:body'\n   - Now responds to both initial page load AND custom refresh events\n\n2. **web/static/js/manage-page.js**\n   - Updated all 4 entity manager onSuccess callbacks\n   - Now dispatches 'refreshManage' CustomEvent on document.body\n\n3. **web/static/js/entity-helpers.js**\n   - Updated refreshEntityDropdown function\n   - Dispatches 'refreshManage' event when on manage page\n\nThe custom event approach is cleaner than triggering 'load' programmatically and ensures proper event bubbling for HTMX to catch."},{"timestamp":"2026-01-31T16:00:19.33430635Z","author":"patrick","message":"## Bug Fix: Delete not refreshing table\n\nFound that the delete() method in entity-manager.js wasn't calling the onSuccess callback, while save() was.\n\n**Modified:** web/static/js/entity-manager.js (lines 154-162)\n- Added onSuccess callback invocation after cache invalidation in delete method\n- Now both save() and delete() trigger the refreshManage event\n- Delete operations will now properly refresh the manage page tables"},{"timestamp":"2026-01-31T16:02:50.833338786Z","author":"patrick","message":"## Additional fix for delete refresh\n\nThe onSuccess callback approach wasn't sufficient for deletes. Added explicit event dispatching:\n\n**Modified files:**\n1. web/static/js/entity-manager.js\n   - delete() method now returns boolean (true if successful, false if cancelled/failed)\n   \n2. web/static/js/manage-page.js  \n   - All delete methods now check return value and dispatch refreshManage only on success\n   - Prevents refresh if user cancels the confirmation dialog\n\n**Flow:**\n1. User clicks Delete → Alpine.js calls deleteBean/deleteRoaster/etc\n2. Entity manager shows confirmation dialog\n3. If cancelled: return false, no refresh\n4. If confirmed: DELETE request → return true\n5. manage-page.js receives true → dispatches refreshManage event\n6. HTMX hears event → reloads table\n\nThis is more reliable than relying solely on the onSuccess callback."},{"timestamp":"2026-01-31T16:08:49.961660711Z","author":"patrick","message":"## SOLUTION: Converted delete to use HTMX instead of Alpine.js\n\nThe root issue was mixing patterns - Edit used HTMX but Delete used Alpine.js + JavaScript fetch. This created inconsistency and timing issues.\n\n**Changed:** internal/web/components/manage_partial.templ\n- All delete buttons now use HTMX attributes instead of @click\n- hx-delete=\"/api/beans/{rkey}\" - sends DELETE request\n- hx-confirm=\"Are you sure...\" - built-in confirmation dialog\n- hx-target=\"closest tr\" - targets the parent table row\n- hx-swap=\"outerHTML swap:0.5s\" - removes row with fade animation\n\n**How it works:**\n1. User clicks Delete\n2. HTMX shows confirmation dialog\n3. If confirmed, sends DELETE to /api/beans/{rkey}\n4. Server deletes and returns 200 OK (empty body)\n5. HTMX swaps the table row's outerHTML with empty response\n6. Row instantly vanishes with 0.5s fade effect\n\n**Benefits:**\n- Immediate visual feedback (no full table reload needed)\n- Consistent with Edit button pattern\n- Simpler than JavaScript approach\n- Row-level granularity (only removes what was deleted)\n- No Alpine.js/HTMX coordination issues\n\n**Note:** The delete methods in manage-page.js are now unused and could be cleaned up in a future refactor."}]}
{"id":"01KGAEB648HERFCPSKW446H8SE","title":"Add closed/open status for coffee bean bags","description":"Add a boolean 'closed' field to the bean lexicon. Update UI to:\n1. Filter closed bags from brew dropdown\n2. Show open bags table at top of profile page\n3. Show closed bags table below roasters on profile page\n4. Show all bags in manage page with newest first, adding an 'open' column\n\nChanges needed:\n- Update lexicons/social.arabica.alpha.bean.json\n- Update internal/atproto/records.go for Bean model\n- Update internal/models/models.go\n- Update brew form dropdown to filter closed beans\n- Update profile page layout with separate tables\n- Update manage page table with open/closed column","status":"completed","priority":"high","assignee":"patrick","created_at":"2026-01-31T16:31:57.0649568Z","updated_at":"2026-01-31T16:55:24.596373389Z","completed_at":"2026-01-31T16:43:26.855808963Z","notes":[{"timestamp":"2026-01-31T16:43:26.748989495Z","author":"patrick","message":"Successfully implemented closed bag feature:\n- Added 'closed' boolean field to bean lexicon\n- Updated Bean model and request structs\n- Updated record conversion functions\n- Filtered closed bags from brew form dropdown\n- Split beans table on profile page into open bags (top) and closed bags (below roasters)\n- Added Status column to manage page beans table with Open/Closed badges\n- Added checkbox to bean form modals for marking bags as closed\n- Updated form handlers to parse closed field\nAll changes tested and verified to compile successfully."},{"timestamp":"2026-01-31T16:50:21.14203731Z","author":"patrick","message":"Fixed bean editing/closing issue:\n- Removed method='dialog' from all entity form dialogs (bean, roaster, grinder, brewer)\n- Added HTMX event handler to close dialog after successful submission\n- Added 'closed: false' to beanManager defaultFormData in manage-page.js\n- Updated editBean() to accept and pass closed parameter\n- Forms now properly submit via HTMX before closing\n- The 'closed' checkbox value is now correctly saved to PDS"},{"timestamp":"2026-01-31T16:55:24.581637936Z","author":"patrick","message":"Additional debugging and fixes:\n- Added explicit hx-trigger='submit' to all dialog forms to ensure HTMX intercepts form submission\n- Changed Alpine.js @ syntax to hx-on:: syntax for HTMX event handlers for better compatibility\n- Added explicit value='true' to closed checkbox for clearer form data\n- Updated handlers to check for 'true' instead of 'on' for closed field\n- Added debug logging to show what values are being received in handlers\n\nPlease test again and check server logs for debug output showing the closed_value and closed_parsed fields."}]}
{"id":"01KGAW0BCP3ZN415GBW40JFYST","title":"Use consistent default profile picture across profile and feed pages","description":"The default avatar fallback on the profile page uses bg-brown-300 (lighter brown) for large size, while the feed uses bg-brown-600 (darker brown) for medium size. This creates visual inconsistency. Update the Avatar component to use the same background color (bg-brown-300) for all sizes to maintain consistency across the app.","status":"completed","priority":"normal","assignee":"patrick","created_at":"2026-01-31T20:30:42.070239386Z","updated_at":"2026-01-31T20:32:38.61578807Z","completed_at":"2026-01-31T20:32:38.60500932Z"}
{"id":"01KGAW9PRR6X6WHKCZVKY2KQBH","title":"Add hover effect to profile avatars","description":"Add visual hover effects to profile avatars throughout the app (feed, header, profile pages). The effect should provide visual feedback when users hover over clickable profile pictures. Consider adding a subtle scale transform, glow effect, or ring color change to indicate interactivity.","status":"completed","priority":"normal","assignee":"patrick","created_at":"2026-01-31T20:35:48.632605618Z","updated_at":"2026-01-31T21:13:34.89255148Z","completed_at":"2026-01-31T20:37:03.856961732Z","notes":[{"timestamp":"2026-01-31T20:37:00.955611391Z","author":"patrick","message":"## Hover Effects Added\n\nUpdated the Avatar component in internal/web/components/shared.templ to add interactive hover effects:\n\n**For image avatars (all sizes):**\n- transition-all duration-200 - Smooth transitions for all properties\n- hover:ring-amber-400 - Ring color changes to amber on hover\n- hover:ring-4 - Ring grows thicker on hover (from ring-2 to ring-4)\n- hover:scale-110 (sm/md) - Avatar scales to 110% on hover\n- hover:scale-105 (lg) - Large avatars scale to 105% (subtler)\n\n**For fallback avatars (initials):**\n- Same transition and ring effects for sm/md sizes\n- hover:bg-brown-400 for large size (background darkens slightly)\n- hover:scale-110 (sm/md) and hover:scale-105 (lg)\n\n**Also fixed:**\n- Updated fallback avatar ring color from ring-brown-600 to ring-brown-500 for consistency with image avatars\n\n**Effect:**\n- Avatars in the feed, header, and profile pages now have smooth, visually appealing hover effects\n- The amber ring glow provides clear visual feedback that the avatar is clickable\n- Scale transform adds a subtle \"lift\" effect that feels responsive\n- 200ms duration provides smooth transitions without lag"},{"timestamp":"2026-01-31T21:13:34.87780839Z","author":"patrick","message":"## Final Implementation\n\nUpdated avatar hover effects based on feedback:\n\n**Changes:**\n1. Changed hover ring color from amber-400 (yellow) to brown-400 (more brown tone)\n2. Removed all scale transforms - avatars stay the same size on hover\n3. Only the ring/border changes color and thickness\n\n**Hover Effects (all sizes):**\n- transition-all duration-200 - Smooth 200ms transitions\n- hover:ring-brown-400 (sm/md) - Ring color changes to lighter brown\n- hover:border-brown-400 (lg) - Border color changes to lighter brown  \n- hover:ring-4 / hover:border-4 - Ring/border grows from 2px to 4px thickness\n- hover:bg-brown-400 (lg fallback only) - Background darkens slightly\n\n**Result:**\n- Subtle, elegant hover effect that doesn't distort the avatar\n- Brown color palette stays consistent with the app theme\n- Clear visual feedback that avatars are clickable\n- Works across feed, header, and profile pages"}]}
{"id":"01KGAYXQVTNKFSNEBYZHV0XVPG","title":"Remove unused Go functions in atproto package","description":"Several exported functions in the atproto package are completely unused:\n\n1. ResolveBeanRef() - internal/atproto/resolver.go:78\n   - Wrapper for resolveRef() that's never called\n   - ResolveBeanRefWithRoaster() is used instead\n\n2. GetSessionDataFromContext() - internal/atproto/oauth.go:203\n   - Leftover from refactoring, never called\n\n3. RequireAuth() - internal/atproto/oauth.go:212\n   - Alternative auth middleware that's never registered\n\n4. Commented-out fetchAllData() - internal/handlers/handlers.go:1530-1564\n   - Replaced by inline errgroup usage\n\nAdditionally verify if these are truly unused:\n- DeleteAuthRequestInfo() in boltstore/session_store.go\n- DeleteAllSessionsForDID() in boltstore/session_store.go\n\nAcceptance criteria:\n- Remove all confirmed dead code\n- Verify no external usage exists\n- Run tests to confirm nothing breaks","status":"completed","priority":"high","created_at":"2026-01-31T21:21:42.26644177Z","updated_at":"2026-01-31T21:28:01.229416423Z","completed_at":"2026-01-31T21:28:01.218546904Z","notes":[{"timestamp":"2026-01-31T21:27:57.208998517Z","author":"patrick","message":"Successfully removed unused Go functions:\n\nREMOVED:\n1. ResolveBeanRef() from internal/atproto/resolver.go:78 - Confirmed unused, only ResolveBeanRefWithRoaster() is used\n2. GetSessionDataFromContext() from internal/atproto/oauth.go:203 - Confirmed unused\n3. RequireAuth() from internal/atproto/oauth.go:212 - Confirmed unused middleware\n4. DeleteAllSessionsForDID() from internal/database/boltstore/session_store.go:168 - Confirmed unused\n\nRETAINED:\n- DeleteAuthRequestInfo() in boltstore/session_store.go - Required by oauth.ClientAuthStore interface, cannot be removed\n\nNOT FOUND:\n- Commented-out fetchAllData() in handlers.go - Already removed in previous cleanup\n\nVERIFICATION:\n- Searched codebase to confirm no usage of removed functions\n- go build completes without errors\n- All tests pass (go test ./...)"}]}
{"id":"01KGAYXQY6N1RPV042XF9907N6","title":"Refactor entity CRUD handlers to reduce duplication","description":"The handlers.go file contains significant code duplication across entity CRUD operations:\n\n**Create handlers (4 nearly identical):**\n- HandleBeanCreate (lines 897-960)\n- HandleRoasterCreate (lines 963-1011)\n- HandleGrinderCreate (lines 1223-1272)\n- HandleBrewerCreate (lines 1359-1407)\n\n**Update handlers (4 nearly identical):**\n- HandleBeanUpdate (lines 1039-1114)\n- HandleRoasterUpdate (lines 1139-1198)\n- HandleGrinderUpdate (lines 1274-1334)\n- HandleBrewerUpdate (lines 1409-1468)\n\nEach follows the exact same pattern:\n1. Check authentication\n2. Parse Content-Type (JSON vs form)\n3. Decode request body\n4. Validate request\n5. Call store method\n6. Encode JSON response\n\n**Proposed refactoring:**\nCreate a generic handler factory or helper that accepts:\n- Request type struct\n- Entity type/NSID\n- Form field mapping\n- Store method reference\n\nThis could reduce 500+ lines of repetitive code.\n\nAcceptance criteria:\n- Extract common logic into reusable functions\n- Reduce total lines by at least 300\n- Maintain all existing functionality\n- All tests pass","status":"completed","priority":"normal","created_at":"2026-01-31T21:21:42.342615886Z","updated_at":"2026-01-31T21:28:10.769242471Z","completed_at":"2026-01-31T21:28:10.756429903Z","notes":[{"timestamp":"2026-01-31T21:28:08.516192437Z","author":"patrick","message":"Refactoring completed successfully.\n\nChanges made:\n1. Added 3 new helper functions:\n   - isJSONRequest() - Checks if request Content-Type is JSON\n   - decodeRequest() - Generic decoder for JSON or form data\n   - writeJSON() - Standardized JSON response encoding\n\n2. Refactored 8 entity CRUD handlers to use helpers:\n   - HandleBeanCreate, HandleBeanUpdate\n   - HandleRoasterCreate, HandleRoasterUpdate\n   - HandleGrinderCreate, HandleGrinderUpdate\n   - HandleBrewerCreate, HandleBrewerUpdate\n\nResults:\n- Reduced file from 2239 to 2185 lines (54 lines removed)\n- Eliminated duplication of Content-Type parsing logic (8 occurrences)\n- Eliminated duplication of form parsing logic (8 occurrences)\n- Eliminated duplication of JSON encoding logic (8 occurrences)\n- All handlers now follow consistent patterns\n- All tests pass (15 test cases, 100% pass rate)\n- Code successfully compiles\n\nPattern established:\nEach handler now follows a clean, consistent flow:\n1. Authenticate via getAtprotoStore()\n2. Decode via decodeRequest() helper\n3. Validate request\n4. Execute store operation\n5. Encode response via writeJSON() helper\n\nThe refactoring makes it much easier to add new entity types in the future by following the established pattern."}]}
{"id":"01KGAYXR0JP80F5KCQG26VHF5B","title":"Remove deprecated modal component files","description":"Several modal component files are marked as deprecated and should be removed:\n\n**Files to remove:**\n1. internal/web/components/modal.templ\n   - Contains Alpine.js x-show based Modal components\n   - Comment: 'This file is kept only for backwards compatibility and will be removed in a future cleanup'\n\n2. internal/web/components/modal_templ.go (generated)\n\n3. internal/web/components/entity_modals.templ\n   - Contains deprecated Alpine.js modals for Bean, Grinder, Brewer, Roaster\n   - Superseded by dialog_modals.templ using native HTML5 \u003cdialog\u003e\n\n4. internal/web/components/entity_modals_templ.go (generated)\n\n**Also update:**\n- internal/web/pages/components_test.go has test 'Modal with static title' that tests deprecated component\n\n**Current replacement:**\n- dialog_modals.templ uses native HTML5 \u003cdialog\u003e elements\n\nAcceptance criteria:\n- Remove all deprecated modal files\n- Update or remove any tests using deprecated components\n- Verify no imports reference removed files\n- App still functions correctly","status":"completed","priority":"normal","created_at":"2026-01-31T21:21:42.418646862Z","updated_at":"2026-01-31T21:26:34.970210414Z","completed_at":"2026-01-31T21:26:34.955317746Z","notes":[{"timestamp":"2026-01-31T21:26:34.938735417Z","author":"patrick","message":"All deprecated modal component files have been successfully removed:\n\nFiles removed:\n- internal/web/components/modal.templ\n- internal/web/components/modal_templ.go\n- internal/web/components/entity_modals.templ\n- internal/web/components/entity_modals_templ.go\n\nTest updates:\n- Removed TestModalComponents from internal/web/pages/components_test.go\n\nVerification:\n- No code references to removed components remain\n- All web page tests pass\n- The app uses dialog_modals.templ for all modal functionality"}]}
{"id":"01KGAYXR359TWZPS2AJF9ZB4S5","title":"Extract profile data fetching into reusable function","description":"Two handlers contain nearly identical ~100-line blocks for fetching user profile data:\n\n**Duplicated in:**\n1. HandleProfile (lines 1628-1733)\n2. HandleProfilePartial (lines 1875-1980)\n\nBoth do:\n- Create errgroup context\n- Fetch beans, roasters, grinders, brewers, brews in parallel\n- Parse records and build lookup maps\n- Resolve references between entities\n\n**Proposed refactoring:**\nExtract into a single helper function:\n\nfunc (h *Handler) fetchUserData(ctx context.Context, did string, publicClient *atproto.PublicClient) (*UserDataBundle, error)\n\nThis function would return a struct containing:\n- Beans (with roasters resolved)\n- Roasters\n- Grinders\n- Brewers\n- Brews (with all refs resolved)\n\nAcceptance criteria:\n- Create fetchUserData helper function\n- Refactor both handlers to use it\n- Reduce duplicated code by ~80-100 lines\n- All profile functionality works as before","status":"completed","priority":"low","created_at":"2026-01-31T21:21:42.501437644Z","updated_at":"2026-01-31T21:32:30.483213969Z","completed_at":"2026-01-31T21:32:30.468389045Z"}
{"id":"01KGB1KDNNZZ7ZDA5NCK0T4E1G","title":"Create shared entity table components for profile and manage pages","description":"## Summary\nRefactor the profile and manage page tables to use shared components, reducing duplication and improving maintainability.\n\n## Current State\n- `manage_partial.templ` has tables for beans, roasters, grinders, brewers with Edit/Delete actions\n- `profile_partial.templ` has similar tables but without actions\n- Beans on profile are split into \"Open Bags\" and \"Closed Bags\" sections\n- Significant HTML/structure duplication between the two files\n\n## Proposed Solution\nCreate shared table components with configurable props:\n\n### Shared Components to Create\n1. **BeansTable** - shared beans table component\n2. **RoastersTable** - shared roasters table component  \n3. **GrindersTable** - shared grinders table component\n4. **BrewersTable** - shared brewers table component\n\n### Props Pattern\nEach component should accept props that control behavior:\n\n```go\ntype EntityTableProps struct {\n    Items        []*models.Entity\n    ShowActions  bool              // Whether to render Edit/Delete column\n    // Other entity-specific options as needed\n}\n```\n\n### Beans Table Special Handling\nThe beans table has unique requirements:\n- Manage page: single table with Status column, shows all beans\n- Profile page: split into Open/Closed sections, no Status column\n\nOptions to handle this:\n1. **Single component with `ShowStatus` prop** - manage uses it, profile calls it twice with filtered lists\n2. **`GroupByStatus` prop** - component internally groups and renders sections\n3. Keep beans separate if complexity doesn't warrant sharing\n\nRecommend option 1 - simpler, profile already filters beans via `filterOpenBeans`/`filterClosedBeans`.\n\n### Actions Implementation\nWhen `ShowActions: true`:\n- Render action column header\n- Render Edit button with `hx-get=\"/api/modals/{entity}/{rkey}\"`\n- Render Delete button with `hx-delete=\"/api/{entities}/{rkey}\"`\n\n### Files to Modify\n- `internal/web/components/manage_partial.templ` - use shared components\n- `internal/web/components/profile_partial.templ` - use shared components\n- `internal/web/components/entity_tables.templ` (new) - shared table components\n\n### Acceptance Criteria\n- [ ] Shared table components created in `entity_tables.templ`\n- [ ] `manage_partial.templ` refactored to use shared components\n- [ ] `profile_partial.templ` refactored to use shared components\n- [ ] Actions can be enabled/disabled via props\n- [ ] No visual regressions on manage page\n- [ ] No visual regressions on profile page\n- [ ] `templ generate` runs successfully\n- [ ] Tests pass (if any)","status":"completed","priority":"normal","assignee":"patrick","labels":["frontend","refactoring"],"created_at":"2026-01-31T22:08:29.877786981Z","updated_at":"2026-01-31T22:16:42.669635082Z","completed_at":"2026-01-31T22:16:42.657711384Z"}
{"id":"01KGB2WBMP539SFSKZCKJAYH0C","title":"Prevent line wrap between emoji and text in table headers","description":"Add whitespace-nowrap to table header cells to prevent the emoji and column name from wrapping onto separate lines.","status":"completed","priority":"normal","assignee":"patrick","labels":["frontend"],"created_at":"2026-01-31T22:30:51.286845962Z","updated_at":"2026-01-31T22:31:23.380048647Z","completed_at":"2026-01-31T22:31:23.369060496Z"}
{"id":"01KGBF5Q2KJ8PZNSMJPFFF31C8","title":"Add AT Protocol explanation page","description":"Create a page explaining what the AT Protocol is that the footer link redirects to instead of atproto.com.\n\nAcceptance criteria:\n- New /atproto page explaining the AT Protocol\n- Footer AT Protocol link redirects to /atproto instead of external site\n- Page matches site design system\n- Explains what AT Protocol is and how Arabica uses it\n- Links to atproto.com for those who want more info","status":"claimed","priority":"normal","assignee":"patrick","created_at":"2026-02-01T02:05:40.819263564Z","updated_at":"2026-02-01T02:10:19.29363426Z","notes":[{"timestamp":"2026-02-01T02:10:19.279321594Z","author":"patrick","message":"Initial implementation complete:\n- Created /atproto page with AT Protocol explanation\n- Updated footer link to point to /atproto instead of external site\n- Added route and handler\n- Page covers: PDS, DIDs, Lexicons, AT-URIs, how Arabica uses ATProto\n- Includes links to atproto.com for more info\nReady for review and final polish"}]}
{"id":"01KGBM1YCGZRNTVCJDZFV3100R","title":"Move web/static to static directory","description":"Move web/static directory to top-level static directory and update all references across the codebase.\n\nFiles to update:\n- flake.nix (tailwindcss paths)\n- .gitignore (output.css path)\n- justfile (tailwindcss paths)\n- default.nix (tailwindcss paths)\n- .gitattributes (vendored JS paths)\n- internal/routing/routing.go (file server path)\n- deploy/Dockerfile (COPY command)\n- CLAUDE.md (documentation)\n\nAcceptance criteria:\n- web/static moved to static/\n- All references updated\n- Server still serves static files correctly\n- Tailwind CSS build still works","status":"completed","priority":"normal","assignee":"patrick","created_at":"2026-02-01T03:31:00.112467261Z","updated_at":"2026-02-01T03:32:59.754877212Z","completed_at":"2026-02-01T03:32:59.739794374Z"}
